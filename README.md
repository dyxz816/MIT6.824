# MIT6.824
基于MIT分布式课程6.824的lab

###代码结构
+ MapReduce的代码实现在src/mr的coordinator.go、rpc.go、worker.go里
+ Raft的代码实现在src/raft的raft.go里
+ key/value数据库的实现在src/kvraft的client.go、server.go、common.go里
## MapReduce
##### MapReduce是一种编程模型，用于大规模数据集（大于1TB）的并行运算。概念"Map（映射）"和"Reduce（归约）"，是它们的主要思想，都是从函数式编程语言里借来的，还有从矢量编程语言里借来的特性。它极大地方便了编程人员在不会分布式并行编程的情况下，将自己的程序运行在分布式系统上。  
## 本次所实现的MapReduce的工作原理
+ 一个任务调度者进程coordinator调度若干个任务执行者进程worker去执行map和reduce任务。整个任务一开始的时候是启动coordinator进程，coordinator进程将初始化存储工作进度信息的数据结构，启动容灾线程，启动rpc服务。然后启动若干个worker进程，worker进程通过rpc向coordinator进程获取任务。coordinator进程根据工作进度的情况给每个worker进程分配任务，然后修改工作进度信息。worker进程执行完被分配的任务后通过rpc告知coordinator进程，coordinator进程修改工作进度信息，worker进程随即又通过rpc向coordinator进程获取下一个任务。
+ 当所有的map任务执行完了之后coordinator进程再向worker进程分配reduce任务，map任务的工作结果以json文件的形式保存。
+ coordinator代码中涉及到读写工作进度信息的地方都用了锁，实现互斥。
+ 容灾线程不停地轮询工作进度信息中存放已分配但是还没有完成的map和reduce任务的最近一次分配时间，如果当前时间与最近一次分配时间之差大于5秒，那么判定该任务已经挂了，当有新的worker进程来获取任务时就把该任务重新分配给这个worker进程并更新最近一次分配时间。
##Raft
#####Raft 是一种为了管理复制日志的一致性算法。它提供了和 Paxos 算法相同的功能和性能，但是它的算法结构和 Paxos 不同，使得 Raft 算法更加容易理解并且更容易构建实际的系统。为了提升可理解性，Raft 将一致性算法分解成了几个关键模块，例如领导人选举、日志复制和安全性。同时它通过实施一个更强的一致性来减少需要考虑的状态的数量。从一个用户研究的结果可以证明，对于学生而言，Raft 算法比 Paxos 算法更加容易学习。Raft 算法还包括一个新的机制来允许集群成员的动态改变，它利用重叠的大多数来保证安全性。
##Raft 一致性算法
#####Raft 通过选举一个高贵的领导人，然后给予他全部的管理复制日志的责任来实现一致性。领导人从客户端接收日志条目(log entries)，把日志条目复制到其他服务器上，并且当保证安全性的时候告诉其他的服务器应用日志条目到他们的状态机中。拥有一个领导人大大简化了对复制日志的管理。例如，领导人可以决定新的日志条目需要放在日志中的什么位置而不需要和其他服务器商议，并且数据都从领导人流向其他服务器。一个领导人可能会宕机，或者和其他服务器失去连接，在这种情况下一个新的领导人会被选举出来。通过领导人的方式，Raft 将一致性问题分解成了三个相对独立的子问题。
+ 领导选举：当现存的领导人宕机的时候, 一个新的领导人需要被选举出来。
+ 日志复制：领导人必须从客户端接收日志条目(log entries)然后复制到集群中的其他节点，并且强制要求其他节点的日志保持和自己相同。
+ 安全性：如果有任何的服务器节点已经应用了一个确定的日志条目到它的状态机中，那么其他服务器节点不能在同一个日志索引位置应用一个不同的指令。
##本次实现的Raft的工作原理
（说来话长，以后有时间再写）
